library("dplyr")
library("SparkR")
ruta = "C:\\Users\\ulloa-to\\Documents\\RS_GIS_PhDBackupDaten\\population_medellin\\census_medellin\\"
# Read the data
data_BU <- read.csv(paste(ruta,"CNPV2018_1VIV_05001.csv", sep = ""), header = T, encoding = "UTF-8",sep = ",")
# Convert the code of the sector to factor
data_BU$COD_MN <- as.factor(data_BU$COD_MN)
# Count by SECTOR the number of items in BULDINGs
VAR_datos_BU <- data.frame(data_BU %>% group_by(COD_MN) %>% summarize(count=n()))
library("dplyr")
ruta = "C:\\Users\\ulloa-to\\Documents\\RS_GIS_PhDBackupDaten\\population_medellin\\census_medellin\\"
# Read the data
data_BU <- read.csv(paste(ruta,"CNPV2018_1VIV_05001.csv", sep = ""), header = T, encoding = "UTF-8",sep = ",")
# Convert the code of the sector to factor
data_BU$COD_MN <- as.factor(data_BU$COD_MN)
# Count by SECTOR the number of items in BULDINGs
VAR_datos_BU <- data.frame(data_BU %>% group_by(COD_MN) %>% summarize(count=n()))
VAR_SECTOR <- data.frame(id = matrix("", nrow = 239, ncol = 1))
VAR_SECTOR <- data.frame(VAR_SECTOR, COD_MN = VAR_datos_BU$COD_MN)
VAR_SECTOR$id <- NULL
# save the count (number of BULDINGs per SECTOR)
VAR_SECTOR <- VAR_SECTOR %>% left_join(VAR_datos_BU, by = "COD_MN") %>% rename(count_BU = count)
datos_BU_USO1 <- data.frame(data_BU[which(data_BU$UVA_USO_UN == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_USO2 <- data.frame(data_BU[which(data_BU$UVA_USO_UN == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_USO1, by = "COD_MN") %>% rename(count_BU_USO1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_USO2, by = "COD_MN") %>% rename(count_BU_USO2 = count)
datos_BU_TIPO1 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO2 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO3 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 3),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO4 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 4),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO5 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 5),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO6 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 6),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO1, by = "COD_MN") %>% rename(count_BU_TIPO1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO2, by = "COD_MN") %>% rename(count_BU_TIPO2 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO3, by = "COD_MN") %>% rename(count_BU_TIPO3 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO4, by = "COD_MN") %>% rename(count_BU_TIPO4 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO5, by = "COD_MN") %>% rename(count_BU_TIPO5 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO6, by = "COD_MN") %>% rename(count_BU_TIPO6 = count)
datos_BU_EST1 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST2 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST3 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 3),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST4 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 4),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST5 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 5),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST6 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 6),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST1, by = "COD_MN") %>% rename(count_BU_EST1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST2, by = "COD_MN") %>% rename(count_BU_EST2 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST3, by = "COD_MN") %>% rename(count_BU_EST3 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST4, by = "COD_MN") %>% rename(count_BU_EST4 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST5, by = "COD_MN") %>% rename(count_BU_EST5 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST6, by = "COD_MN") %>% rename(count_BU_EST6 = count)
## Unique values: 0 - 18.
# Aquí se calculó el promedio, media, sd, max y min de la cantidad de hogares por vivienda
# Count
datos_BU_HH <- data.frame(data_BU[!is.na(data_BU$V_TOT_HOG),] %>% group_by(COD_MN) %>% summarize(sum = sum(V_TOT_HOG),mean = mean(V_TOT_HOG),
sd = sd(V_TOT_HOG),median = median(V_TOT_HOG),
min = min(V_TOT_HOG),max = max(V_TOT_HOG)))
# add to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_HH, by = "COD_MN") %>% rename(sum_BU_HH = sum, mean_BU_HH = mean, sd_BU_HH = sd,
median_BU_HH = median, min_BU_HH = min, max_BU_HH = max)
datos_VB_ACU0 <- data.frame(data_BU[which(data_BU$VB_ACU == 0),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VB_ACU1 <- data.frame(data_BU[which(data_BU$VB_ACU == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VB_ACU2 <- data.frame(data_BU[which(data_BU$VB_ACU == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VB_ACU0, by = "COD_MN") %>% rename(count_BU_ACU0 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VB_ACU1, by = "COD_MN") %>% rename(count_BU_ACU1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VB_ACU2, by = "COD_MN") %>% rename(count_BU_ACU2 = count)
## Unique values: 1, 2, 0.
# count
datos_VC_ALC0 <- data.frame(data_BU[which(data_BU$VC_ALC == 0),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VC_ALC1 <- data.frame(data_BU[which(data_BU$VC_ALC == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VC_ALC2 <- data.frame(data_BU[which(data_BU$VC_ALC == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VC_ALC0, by = "COD_MN") %>% rename(count_BU_ALC0 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VC_ALC1, by = "COD_MN") %>% rename(count_BU_ALC1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VC_ALC2, by = "COD_MN") %>% rename(count_BU_ALC2 = count)
datos_VE_RECBAS0 <- data.frame(data_BU[which(data_BU$VE_RECBAS == 0),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VE_RECBAS1 <- data.frame(data_BU[which(data_BU$VE_RECBAS == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VE_RECBAS2 <- data.frame(data_BU[which(data_BU$VE_RECBAS == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VE_RECBAS0, by = "COD_MN") %>% rename(count_VE_RECBAS0 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VE_RECBAS1, by = "COD_MN") %>% rename(count_VE_RECBAS1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VE_RECBAS2, by = "COD_MN") %>% rename(count_VE_RECBAS2 = count)
## Unique values: 0-9
# Aquí se calculó el promedio, media, sd, max y min de la cantidad de hogares por vivienda
# Count
datos_BU_BASU <- data.frame(data_BU[!is.na(data_BU$VE1_QSEM),] %>% group_by(COD_MN) %>% summarize(sum = sum(VE1_QSEM),mean = mean(VE1_QSEM),
sd = sd(VE1_QSEM),median = median(VE1_QSEM),
min = min(VE1_QSEM),max = max(VE1_QSEM)))
# add to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_BASU, by = "COD_MN") %>% rename(sum_BU_BASU = sum, mean_BU_BASU = mean, sd_BU_BASU = sd,
median_BU_BASU = median, min_BU_BASU = min, max_BU_BASU = max)
datos_BU_V_TIPO_SER0 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 0),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER1 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER2 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER3 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 3),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER4 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 4),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER5 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 5),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER6 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 6),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER7 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 7),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER8 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 8),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER9 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 9),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER0, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER0 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER1, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER2, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER2 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER3, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER3 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER4, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER4 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER5, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER5 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER6, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER6 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER7, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER7 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER8, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER8 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER9, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER9 = count)
# export df as csv
write.csv(VAR_SECTOR, paste0(ruta, "CENSO_VIVIENDAS_2018.csv"))
ruta = "C:\\Users\\ulloa-to\\Documents\\RS_GIS_PhDBackupDaten\\population_medellin\\census_medellin\\"
# Read the data
data_BU <- read.csv(paste(ruta,"CNPV2018_1VIV_05001.csv", sep = ""), header = T, encoding = "UTF-8",sep = ",")
# Convert the code of the sector to factor
data_BU$COD_MN <- as.factor(data_BU$COD_MN)
library("dplyr")
# Count by SECTOR the number of items in BULDINGs
VAR_datos_BU <- data.frame(data_BU %>% group_by(COD_MN) %>% summarize(count=n()))
# 2: 2 Veces
# 3: 3 Veces
# 4: 4 Veces
# 5: 5 Veces
# 6: 6 Veces
# 7: 7 Veces
# 8: Mayor periodicidad
# 9: No Sabe
# No Aplica
# Check first the unique values for this column
View(table(data_BU$VE1_QSEM))
## Unique values: 0-9
# Aquí se calculó el promedio, media, sd, max y min de la cantidad de hogares por vivienda
# Count
datos_BU_BASU <- data.frame(data_BU[!is.na(data_BU$VE1_QSEM),] %>% group_by(COD_MN) %>% summarize(sum = sum(VE1_QSEM),mean = mean(VE1_QSEM),
sd = sd(VE1_QSEM),median = median(VE1_QSEM),
min = min(VE1_QSEM),max = max(VE1_QSEM)))
View(datos_BU_BASU)
VAR_SECTOR <- data.frame(id = matrix("", nrow = 239, ncol = 1))
VAR_SECTOR <- data.frame(VAR_SECTOR, COD_MN = VAR_datos_BU$COD_MN)
VAR_SECTOR$id <- NULL
View(head(VAR_SECTOR))
# save the count (number of BULDINGs per SECTOR)
VAR_SECTOR <- VAR_SECTOR %>% left_join(VAR_datos_BU, by = "COD_MN") %>% rename(count_BU = count)
## Unique values: 1, 2.
# Count
datos_BU_USO1 <- data.frame(data_BU[which(data_BU$UVA_USO_UN == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_USO2 <- data.frame(data_BU[which(data_BU$UVA_USO_UN == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_USO1, by = "COD_MN") %>% rename(count_BU_USO1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_USO2, by = "COD_MN") %>% rename(count_BU_USO2 = count)
datos_BU_TIPO1 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO2 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO3 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 3),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO4 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 4),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO5 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 5),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_TIPO6 <- data.frame(data_BU[which(data_BU$V_TIPO_VIV == 6),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO1, by = "COD_MN") %>% rename(count_BU_TIPO1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO2, by = "COD_MN") %>% rename(count_BU_TIPO2 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO3, by = "COD_MN") %>% rename(count_BU_TIPO3 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO4, by = "COD_MN") %>% rename(count_BU_TIPO4 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO5, by = "COD_MN") %>% rename(count_BU_TIPO5 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_TIPO6, by = "COD_MN") %>% rename(count_BU_TIPO6 = count)
# VA1_ESTRATO (estrato de la vivienda)
# Check first the unique values for this column
View(table(data_BU$VA1_ESTRATO))
datos_BU_EST1 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST2 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST3 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 3),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST4 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 4),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST5 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 5),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_EST6 <- data.frame(data_BU[which(data_BU$VA1_ESTRATO == 6),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST1, by = "COD_MN") %>% rename(count_BU_EST1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST2, by = "COD_MN") %>% rename(count_BU_EST2 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST3, by = "COD_MN") %>% rename(count_BU_EST3 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST5, by = "COD_MN") %>% rename(count_BU_EST5 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST6, by = "COD_MN") %>% rename(count_BU_EST6 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_EST4, by = "COD_MN") %>% rename(count_BU_EST4 = count)
## Unique values: 0 - 18.
# Aquí se calculó el promedio, media, sd, max y min de la cantidad de hogares por vivienda
# Count
datos_BU_HH <- data.frame(data_BU[!is.na(data_BU$V_TOT_HOG),] %>% group_by(COD_MN) %>% summarize(sum = sum(V_TOT_HOG),mean = mean(V_TOT_HOG),
sd = sd(V_TOT_HOG),median = median(V_TOT_HOG),
min = min(V_TOT_HOG),max = max(V_TOT_HOG)))
# V_TOT_HOG (numero de hogares)
# Check first the unique values for this column
View(table(data_BU$V_TOT_HOG))
## Unique values: 0 - 18.
# Aquí se calculó el promedio, media, sd, max y min de la cantidad de hogares por vivienda
# Count
datos_BU_HH <- data.frame(data_BU[!is.na(data_BU$V_TOT_HOG),] %>% group_by(COD_MN) %>% summarize(sum = sum(V_TOT_HOG),mean = mean(V_TOT_HOG),
sd = sd(V_TOT_HOG),median = median(V_TOT_HOG),
min = min(V_TOT_HOG),max = max(V_TOT_HOG)))
# add to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_HH, by = "COD_MN") %>% rename(sum_BU_HH = sum, mean_BU_HH = mean, sd_BU_HH = sd,
median_BU_HH = median, min_BU_HH = min, max_BU_HH = max)
## Unique values: 1, 2, 0.
# count
datos_VB_ACU0 <- data.frame(data_BU[which(data_BU$VB_ACU == 0),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VB_ACU1 <- data.frame(data_BU[which(data_BU$VB_ACU == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VB_ACU2 <- data.frame(data_BU[which(data_BU$VB_ACU == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VB_ACU0, by = "COD_MN") %>% rename(count_BU_ACU0 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VB_ACU1, by = "COD_MN") %>% rename(count_BU_ACU1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VB_ACU2, by = "COD_MN") %>% rename(count_BU_ACU2 = count)
## Unique values: 1, 2, 0.
# count
datos_VC_ALC0 <- data.frame(data_BU[which(data_BU$VC_ALC == 0),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VC_ALC1 <- data.frame(data_BU[which(data_BU$VC_ALC == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VC_ALC2 <- data.frame(data_BU[which(data_BU$VC_ALC == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VC_ALC0, by = "COD_MN") %>% rename(count_BU_ALC0 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VC_ALC1, by = "COD_MN") %>% rename(count_BU_ALC1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VC_ALC2, by = "COD_MN") %>% rename(count_BU_ALC2 = count)
## Unique values: 1, 2, 0.
# count
datos_VE_RECBAS0 <- data.frame(data_BU[which(data_BU$VE_RECBAS == 0),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VE_RECBAS1 <- data.frame(data_BU[which(data_BU$VE_RECBAS == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_VE_RECBAS2 <- data.frame(data_BU[which(data_BU$VE_RECBAS == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VE_RECBAS0, by = "COD_MN") %>% rename(count_VE_RECBAS0 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VE_RECBAS1, by = "COD_MN") %>% rename(count_VE_RECBAS1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_VE_RECBAS2, by = "COD_MN") %>% rename(count_VE_RECBAS2 = count)
## Unique values: 0-9
# Aquí se calculó el promedio, media, sd, max y min de la cantidad de hogares por vivienda
# Count
datos_BU_BASU <- data.frame(data_BU[!is.na(data_BU$VE1_QSEM),] %>% group_by(COD_MN) %>% summarize(sum = sum(VE1_QSEM),mean = mean(VE1_QSEM),
sd = sd(VE1_QSEM),median = median(VE1_QSEM),
min = min(VE1_QSEM),max = max(VE1_QSEM)))
# add to df
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_BASU, by = "COD_MN") %>% rename(sum_BU_BASU = sum, mean_BU_BASU = mean, sd_BU_BASU = sd,
median_BU_BASU = median, min_BU_BASU = min, max_BU_BASU = max)
datos_BU_V_TIPO_SER0 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 0),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER1 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 1),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER2 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 2),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER3 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 3),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER4 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 4),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER5 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 5),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER6 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 6),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER7 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 7),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER8 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 8),] %>% group_by(COD_MN) %>% summarize(count=n()))
datos_BU_V_TIPO_SER9 <- data.frame(data_BU[which(data_BU$V_TIPO_SER == 9),] %>% group_by(COD_MN) %>% summarize(count=n()))
# join
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER0, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER0 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER1, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER1 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER2, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER2 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER4, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER4 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER5, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER5 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER3, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER3 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER8, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER8 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER9, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER9 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER6, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER6 = count)
VAR_SECTOR <- VAR_SECTOR %>% left_join(datos_BU_V_TIPO_SER7, by = "COD_MN") %>% rename(count_BU_V_TIPO_SER7 = count)
# export df as csv
write.csv2(VAR_SECTOR, paste0(ruta, "CENSO_VIVIENDAS_2018.csv"))
q()
install.packages("installr")
library(installr)
updateR()
Sys.which("make")
writeLines('PATH="$C:\\rtools40\\usr\\bin;${PATH}"', con = "~/.Renviron")
knitr::opts_chunk$set(echo = TRUE, fig.width=12, fig.height=8, fig.align="center", warning=FALSE, message=FALSE)
knitr::opts_chunk$set(echo = TRUE, fig.width=12, fig.height=8, fig.align="center", warning=FALSE, message=FALSE)
library(knitr)
install.packages("knitr")
library(knitr)
library(knitr)
library(knitr)
library(knitr)
install.packages("knitr")
library(knitr)
knitr::opts_chunk$set(echo = TRUE, fig.width=12, fig.height=8, fig.align="center", warning=FALSE, message=FALSE)
knitr::opts_chunk$set(echo = TRUE, fig.width=12, fig.height=8, fig.align="center", warning=FALSE, message=FALSE)
install.packages("knitr")
.libPaths()
update.packages(checkBuilt=TRUE)
library(knitr)
